<!DOCTYPE html>
<html lang="en">



<head>
	
<title>Blackjack</title>

<link rel="stylesheet" type="text/css" href="app.css">
<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.6.3/jquery.min.js"></script>




</head>

<body>
	

<div id = "hit">HIT</div>
<div id = "stay">STAY</div>
<div id = "player_total"></div>
<div id="dealer_total"></div>
<div id = "player_popup"></div>


<script type="text/javascript">


var card_count = 0
var random_number= 0
var player_total = 0
var ace_count = 0
var dealer_total = 0
var dealer_card_count = 0
var dealer_ace_count = 0

var card_array = ["10_of_clubs.png",
 "10_of_diamonds.png",
 "10_of_hearts.png",
 "10_of_spades.png",
 "2_of_clubs.png",
 "2_of_diamonds.png",
 "2_of_hearts.png",
 "2_of_spades.png",
 "3_of_clubs.png",
 "3_of_diamonds.png",
 "3_of_hearts.png",
 "3_of_spades.png",
 "4_of_clubs.png",
 "4_of_diamonds.png",
 "4_of_hearts.png",
 "4_of_spades.png",
 "5_of_clubs.png",
 "5_of_diamonds.png",
 "5_of_hearts.png",
 "5_of_spades.png",
 "6_of_clubs.png",
 "6_of_diamonds.png",
 "6_of_hearts.png",
 "6_of_spades.png",
 "7_of_clubs.png",
 "7_of_diamonds.png",
 "7_of_hearts.png",
 "7_of_spades.png",
 "8_of_clubs.png",
 "8_of_diamonds.png",
 "8_of_hearts.png",
 "8_of_spades.png",
 "9_of_clubs.png",
 "9_of_diamonds.png",
 "9_of_hearts.png",
 "9_of_spades.png",
 "ace_of_clubs.png",
 "ace_of_diamonds.png",
 "ace_of_hearts.png",
 "ace_of_spades.png",
 "jack_of_clubs.png",
 "jack_of_diamonds.png",
 "jack_of_hearts.png",
 "jack_of_spades.png",
 "king_of_clubs.png",
 "king_of_diamonds.png",
 "king_of_hearts.png",
 "king_of_spades.png",
 "queen_of_clubs.png",
 "queen_of_diamonds.png",
 "queen_of_hearts.png",
"queen_of_spades.png"]



var card_dict = {

"10_of_clubs.png": 10,
"10_of_diamonds.png": 10,
"10_of_hearts.png": 10,
"10_of_spades.png": 10,
"2_of_clubs.png": 2,
"2_of_diamonds.png": 2,
"2_of_hearts.png": 2,
"2_of_spades.png": 2,
"3_of_clubs.png": 3,
"3_of_diamonds.png": 3,
"3_of_hearts.png": 3,
"3_of_spades.png": 3,
"4_of_clubs.png": 4,
"4_of_diamonds.png": 4,
"4_of_hearts.png": 4,
"4_of_spades.png": 4,
"5_of_clubs.png": 5,
"5_of_diamonds.png": 5,
"5_of_hearts.png": 5,
"5_of_spades.png": 5,
"6_of_clubs.png": 6,
"6_of_diamonds.png": 6,
"6_of_hearts.png": 6,
"6_of_spades.png": 6,
"7_of_clubs.png": 7,
"7_of_diamonds.png": 7,
"7_of_hearts.png": 7,
"7_of_spades.png": 7,
"8_of_clubs.png": 8,
"8_of_diamonds.png": 8,
"8_of_hearts.png": 8,
"8_of_spades.png": 8,
"9_of_clubs.png": 9,
"9_of_diamonds.png": 9,
"9_of_hearts.png": 9,
"9_of_spades.png": 9,
"ace_of_clubs.png": 11,
"ace_of_diamonds.png": 11,
"ace_of_hearts.png": 11,
"ace_of_spades.png": 11,
"jack_of_clubs.png": 10,
"jack_of_diamonds.png": 10,
"jack_of_hearts.png": 10,
"jack_of_spades.png": 10,
"king_of_clubs.png": 10,
"king_of_diamonds.png": 10,
"king_of_hearts.png": 10,
"king_of_spades.png": 10,
"queen_of_clubs.png": 10,
"queen_of_diamonds.png": 10,
"queen_of_hearts.png": 10,
"queen_of_spades.png": 10 
}
	


	$(document).ready(function(){


		for(var i = 0; i<2;i++){

			random_number = Math.floor(Math.random()*(52));

			if (card_dict[card_array[random_number]] === 11){

				dealer_ace_count++;

			}

			$('body').append('<div class=\"dealer_div\" style =\"left:' + parseInt(500+i*45, 10)+ 'px\"><img src=\"static/img/' 
				+ card_array[random_number] +'\"/></div>');

			if (i === 0){

				$('#dealer_total').text(card_dict[card_array[random_number]]);

			}

			dealer_total = dealer_total + card_dict[card_array[random_number]];

		}

		

		$('body').append('<div id = \"card_back\"><img src=\"static/img/card_back.jpg\"/></div>');


		$('#hit').click(function(){

			
			if(player_total<=21){

				random_number = Math.floor(Math.random()*(52));

				$('body').append('<div class=\"test\" style =\"left:' + parseInt(400+card_count*45, 10)+ 'px\"><img src=\"static/img/' 
					+ card_array[random_number] +'\"/></div>');

				if (card_dict[card_array[random_number]] === 11){

					ace_count++;

				};

				player_total = player_total + card_dict[card_array[random_number]];

				if(player_total>21 && ace_count>0){

					player_total=player_total-10;
					ace_count=ace_count-1;

				};

				if(player_total>21){

					$('body').append('<div class=\"banner\">You LOSE<div id=\"reload\">New Hand</div></div>');

					$('#reload').click(function(){


						location.reload();

					});
				
				};

				$('#player_total').text(player_total);
				$('#player_popup').text("+" + card_dict[card_array[random_number]]);
				$('#player_popup').fadeIn("fast");
				$('#player_popup').fadeOut("fast");
				



				card_count = card_count + 1;

			}

		});

		$('#stay').click(function(){


			$('#hit').css("display", "none");
			$('#stay').css("display", "none");
			$('#card_back').css("display", "none");
			$('#dealer_total').text(dealer_total);


			var dealer_card_list = ['x'];
			var dealer_total_list = ['x'];
			var dealer_count_list = ['x'];


			dealer_card_count = 2;

			while (dealer_total < 17) {

		
				random_number = Math.floor(Math.random()*(52));

				dealer_card_list.push(card_array[random_number]);
				
				if (card_dict[card_array[random_number]] === 11){

					dealer_ace_count++;

				}

				dealer_total = dealer_total + card_dict[card_array[random_number]];

				if(dealer_total>21 && dealer_ace_count>0){

					dealer_total= dealer_total-10;
					dealer_ace_count=dealer_ace_count-1;

				}
				
				dealer_card_count = dealer_card_count + 1;

				dealer_count_list.push(dealer_card_count);

				dealer_total_list.push(dealer_total);


			}

			for (var i = 1; i<dealer_total_list.length; i++){

				setTimeout(function(x) { return function() { 

					$('body').append('<div class=\"dealer_div\" style =\"left:' + parseInt(500+(dealer_count_list[x]-1)*45, 10)+ 'px\"><img src=\"static/img/' 
					+ dealer_card_list[x] +'\"/></div>');
				
					$('#dealer_total').text(dealer_total_list[x]);

				}; }(i), 500*i);

			}

			setTimeout(function(){

					if(dealer_total>21){

						$('body').append('<div class=\"banner\">DEALER BUSTS<div id=\"reload\">New Hand</div></div>');

					} 

					else if((dealer_total>player_total) && (17<=dealer_total<=21)){

						$('body').append('<div class=\"banner\">YOU LOSE<div id=\"reload\">New Hand</div></div>');
				

					} else if(dealer_total===player_total && 17<=dealer_total<=21){

						$('body').append('<div class=\"banner\">PUSH<div id=\"reload\">New Hand</div></div>');


					} else if(dealer_total<player_total && 17<=dealer_total<=21){

						$('body').append('<div class=\"banner\">YOU WIN<div id=\"reload\">New Hand</div></div>');

					}

					$('#reload').click(function(){


						location.reload();

					});

				}, 500*dealer_total_list.length);
			

		});
		
	});

	

</script>


</body>

</html>